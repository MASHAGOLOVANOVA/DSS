# **Практическая работа №2**

## 1. **Определение API**
   
   В рамках моей работы есть плюсы применения и синхронного апи и ассинхронного.
   Для операций, которые требуют немедленного ответа от приложения стоит использовать синхронный API, а для операций, которые могут выполняться в фоновом режиме, например обработка добавления студента, стоит использовать ассинхронный API.

   Таким образом, стоит ввыбрать смешанный подход. Для получения данных использовать PEST API, а для обработки событий - RabbitMQ.

   RabbitMQ был выбран исходя из следующих преимуществ:
   - поддерживается Go + python - технологический стек системы
   - имеет удобный веб-интерфейс для мониторинга
   - хорошая документация.

   Ранее система была реализована через синхронный API, с помощью фреймворка chi, его выбор был обоснован в П1.

   Было добавлено использование ассинхронного API через RabbitMQ, для обработки событий добавления студентов в tg-bot на python (client) с помощью библиотеки pika и обработку поступившего сообщения на сервере с помощью библиотеки.

   Для telegram бота на python использовалась библиотека pika.

   Библиотека обладает следующими преимуществами:
   - Простота использования
   - Ассинхронная обработка сообщений
   - Гибкая маршрутизация
   - Поддержка подтверждений сообщений
   - Поддержка различных форматов сообщений
   - Хорошая документация засчет популярности библиотеки

   Для сервера go использовалась библиотека github.com/streadway/amqp

   Библиотека обладает следующими плюсами:
   - Поддержка различныхфункций RabbitMQ: управление очередями, отправка и получение сообщений, подтверждение сообщений, маршрутизация сообщений.
   - Ассинхронная обработка сообщений
   - Поддержка различных типов сообщений xml, json (который используется в системе)
   - Простота использования
   
   Репо: https://github.com/MASHAGOLOVANOVA/mvp-2-spms
   
   ПР: [https://github.com/MASHAGOLOVANOVA/mvp-2-spms/pull/1](https://github.com/MASHAGOLOVANOVA/mvp-2-spms/pull/2)

   tg-bot МР: https://gitlab.com/university-stuff-group/spm-tg-bot/-/merge_requests/1/diffs

## 2. **Микросервисы**
  Система была разделена на микросервисы:
  1. Основной сервис (для работы с задачами, встречами, проектами - (планируется дальнейшая декомпозиция на сервсы))
  2. Сервис для работы со студентами
  3. Сервис для работы с университетами

Интерфейсы для сервиса студентов:

![image](https://github.com/user-attachments/assets/ffaa7266-04a3-43dc-bfe7-aa1ca36af9f0)

Интерфейс для сервиса университетов:

![image](https://github.com/user-attachments/assets/34f261eb-65c2-4726-b8f0-eaa096683e6e)


В дальнейшем планируется развивать разбиение на сервисы, на данный момент не хватило времени на реализацию микросервисной архитектуры - очень большое монолитное приложение.

Микросервисная архитектура позволила бы сделать приложение более отказоустойчивым, позволило бы быть гибким в выборе технологий для новых модулей.

## 3. **Docker**

Докерфайл для сервиса по работе со студентами

![image](https://github.com/user-attachments/assets/6ea840f2-20ce-4d67-bf04-1973c26200fa)


Докерфайл для сервиса по работе с университетами

![image](https://github.com/user-attachments/assets/3dc268d4-342a-4d6a-8c7c-36941c14f1b5)


Докер-компоуз файл

Ссылка:  https://github.com/MASHAGOLOVANOVA/mvp-2-spms/blob/dss-practice2/main/docker-compose.yml

## 4. **Тесты**
  Тесты для проверки работы микросервисов
  student-service:
  
  https://github.com/MASHAGOLOVANOVA/mvp-2-spms/blob/dss-practice2/main/student-service/database/student-repository/student_repository.go

  university-service:
  
   https://github.com/MASHAGOLOVANOVA/mvp-2-spms/blob/dss-practice2/main/university-service/database/university-repository/university_repository.go

## 4. **Шаблонный репозиторий**

  В рамках работы репозиториев для всех репозиториев актуальны следующие методы:
  Например getAll(), getById().
  
  Полный круд предусмотрен не для всех репозиториев, так что стоит создать шаблонный репозиторий, состоящий из этих методов.


## 5. **Демонстрация работы системы**

Скриншот демонстрирует работу новых сервисов, в частности работу с RabbitMQ 

![image](https://github.com/user-attachments/assets/50be3c2c-98c0-47b7-b9aa-ec53c83ce1ee)


  
